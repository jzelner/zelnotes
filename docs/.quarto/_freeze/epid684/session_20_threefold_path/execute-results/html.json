{
  "hash": "d70a7c4a5b5261034ba18bb68465693a",
  "result": {
    "markdown": "---\npagetitle: \"The threefold path of multi-level modeling\"\nfontsize: 12pt\nurlcolor: blue\noutput: \n  revealjs::revealjs_presentation:\n    theme: [\"solarize\"]\n    transition: \"fade\"\n    css: \"styles.css\"\n    self_contained: false\n    lib_dir: \".\"\n    reveal_plugins: [\"chalkboard\", \"menu\"]\n    fig_caption: false\n    toggleFullScreenButton: true\n    reveal_options: \n      chalkboard:\n        theme: \"whiteboard\"\n        toggleChalkboardButton: true\n        toggleNotesButton: true\n---\n\n\n# The threefold path of multilevel modeling {#title}\n\n<div class=\"paddeddiv\">\n  <p style=\"font-size:0.5em; text-align: left;\">\n      EPID 684  \n      Spatial Epidemiology  \n      3/24/2022  \n      <br><br>\n      Jon Zelner  \n      `jzelner@umich.edu`  \n      [`epibayes.io`](https://epibayes.io) \n    </p>\n</div>\n\n\n<div class=\"itemr\" id=\"footerDiv\"><img id=\"footerImg\" src=\"../images/epid_logo.png\" width=\"400\"></div>\n\n# Today's <span class=\"alert\">Theme</span> {.imgslide} \n\n<img src=\"../images/radon_entry.png\">\n\n[How do hierarchical models make the most use of multi-level data ](https://publish.obsidian.md/epibayes/Courses/EPID684/modules/Module+4/2.+Digging+into+the+multi-level+approach+to+spatial+analysis)\n\n# Agenda\n\n\n>- Quick overview of prep for thursday [in-class workshop](https://docs.google.com/document/d/1M5Cc-kkibFTGMcLi43pxGTSzZrv5hUg7_dC2puhgNp8/edit).\n\n>- <span class=\"alert\">Worked example</span> of three approaches to multi-level modeling.\n\n>- Discussion of Gelman Minnesota radon ‚ò¢Ô∏è example \n\n\n# Let's <span class=\"alert\">extend</span> the blood pressure model from Merlo et al. to include a <span class=\"alert\">risk/protective</span> factor.\n\n>- Simulated study where we sample 1000 individuals ($i$) from 20 neighborhoods ($j$) and measure:\n\n>- $y_{ij}$ is <span class=\"alert\">continuous</span> systolic blood pressure (SBP) for individual $i$ in location $j$.\n\n>- $x_i \\in [0,1]$ is a binary exposure indicating whether the individual gets regular physical exercise.\n\n>- $\\beta$ is an increase in $y_i$ associated with the exposure \n\n>- $\\alpha$ is <span class=\"alert\">mean</span> SBP in the absence of exposure\n\n# How can we deal with the fact that people are <span class=\"alert\">clustered</span> within locations? \n\n<iframe src=\"https://giphy.com/embed/nz6qNPDA0dpsxbY0rl\" width=\"480\" height=\"304\" frameBorder=\"0\" class=\"giphy-embed\" allowFullScreen></iframe>\n\nYou have <span class=\"alert\">three choices</span>: Which üö™ will you choose?\n\n# Door üö™ #1: Ignore clustering and fit a normal GLM\n\n>- *Pool* data across all units, i.e. ignore clustering.\n\n>- i.e. fit model $y_{ij} = \\alpha + \\beta x_i + \\epsilon_i$\n\n>- Is this typically a good idea?\n\n# <span style=\"color:red\">NO!</span> {.imgslide}\n\n<img src=\"../images/regression_dragon_1.jpg\">\n\nComplete pooling ignores potential sources of *observed* and *unobserved* unit-level <span class=\"alert\">confounding</span>.\n\n\n\n\n# <span class=\"alert\">Full pooling</span> of clustered data violates assumption of independent errors\n\nA <span class=\"alert\"> fully pooled</span> model:\n\n$$\ny_i = \\alpha + \\beta x + \\epsilon_i\n$$\n\n-  Assumes $y_i$ is a combination of systematic variation ($\\alpha + \\beta x$) and *uncorrelated* random noise ($\\epsilon_i$) where:\n\n$$\n\\text{i.i.d.} \\epsilon \\sim Normal(0, \\sigma^2)\n$$\n\n# Your <span class=\"alert\">residuals</span> should look like this\n\n\n::: {.cell}\n::: {.cell-output-display}\n![Example of residuals for model with clustered errors](session_20_threefold_path_files/figure-html/unnamed-chunk-1-1.png){width=672}\n:::\n:::\n\n\n# Your <span class=\"alert\">residuals</span> should look like this\n\n\n::: {.cell}\n::: {.cell-output-display}\n![Example of residuals for model with clustered errors](session_20_threefold_path_files/figure-html/unnamed-chunk-2-1.png){width=672}\n:::\n:::\n\n\n# If you ignore clustering (ICC = 0.9)\n\n\n::: {.cell}\n::: {.cell-output-display}\n![Clustered errors](session_20_threefold_path_files/figure-html/unnamed-chunk-3-1.png){width=672}\n:::\n:::\n\n\n# If you ignore clustering (ICC = 0.9)\n\n\n::: {.cell}\n::: {.cell-output-display}\n![Example of residuals for model with clustered errors](session_20_threefold_path_files/figure-html/unnamed-chunk-4-1.png){width=672}\n:::\n:::\n\n\n\n# If you ignore clustering (ICC = 0.5)\n\n\n::: {.cell}\n::: {.cell-output-display}\n![Clustered errors](session_20_threefold_path_files/figure-html/unnamed-chunk-5-1.png){width=672}\n:::\n:::\n\n\n# If you ignore clustering (ICC = 0.5)\n\n\n::: {.cell}\n::: {.cell-output-display}\n![Example of residuals for model with clustered errors](session_20_threefold_path_files/figure-html/unnamed-chunk-6-1.png){width=672}\n:::\n:::\n\n\n\n# If you ignore clustering (ICC = 0.25)\n\n\n::: {.cell}\n::: {.cell-output-display}\n![Clustered errors](session_20_threefold_path_files/figure-html/unnamed-chunk-7-1.png){width=672}\n:::\n:::\n\n\n# If you ignore clustering (ICC = 0.25)\n\n\n::: {.cell}\n::: {.cell-output-display}\n![Example of residuals for model with clustered errors](session_20_threefold_path_files/figure-html/unnamed-chunk-8-1.png){width=672}\n:::\n:::\n\n\n\n# Door üö™ #2: Fit a <span class=\"alert\">different model</span> to each cluster\n\n\n>- <span class=\"alert\">Unpooled approach:</span>Fit a separate model to each unit ($j$), assuming outcomes in each unit are independent:\n\n>- Model looks like: $y_{ij} = \\alpha_j + \\beta_j x_i + \\epsilon_{ij}$\n\n>- Where: $\\epsilon_{ij} \\sim N(0, \\sigma_{j}^2)$\n\n# <span class=\"danger\">More danger!</span>\n\n<img src=\"../images/regression_dino.jpg\">\n\nTotally unpooled models run the risk of <span class=\"alert\">overfitting</span> the data, particularly in small samples.\n\n# Specific dangers of unpooled models\n\n>- Some places may have few observations, making *unpooled* models impractical\n\n>- We may want to allow the effect of an exposure to be consistent across location. \n\n>- Will have nothing to say about data from a new location\n\n# How would our <span class=\"alert\">ideal</span> model split the difference between fully pooled and totally unpooled?\n\n>- Encode the <span class=\"alert\">assumption</span> that places are similar unless data tell us otherwise.\n\n>- Be <span class=\"alert\">flexible</span> enough to reflect information in new data without <span class=\"alert\">overfitting</span>.\n\n>- Give answers equivalent to the <span class=\"alert\">fully pooled</span> and <span class=\"alert\">unpooled</span> approaches if that is what the data actually suggest.\n\n# Door üö™ #3: Partial Pooling üèä!\n\n>- Allow <span class=\"alert\">effects</span> to vary across clusters, but constrain them to come from the same distribution:\n\n>- Model looks like: $y_{ij} = \\alpha + \\beta x_i + \\epsilon_{i} + \\epsilon_{j}$\n\n>- Where: $\\epsilon_{i} \\sim N(0, \\sigma_{i}^2)$\n\n>- And: $\\epsilon_{j} \\sim N(0, \\sigma_{j}^2)$\n\n# What does partial pooling get us?\n\n>- This approach accommodates variation across units without assuming they have *no* similarity.\n\n>- Allows us to include covariates both about individuals and their spatial context.\n\n>- More likely to make accurate <span class=\"alert\">out-of-sample</span> predictions than the fully-pooled or unpooled examples.\n\n\n# Imagine you're in the <span class=\"alert\">radon system</span> business {.imgslide}\n\n<img src=\"../images/jz_radon.jpg\" style=\"width:25%\">\n\nMy very own radon mitigation system!\n\n# How could you use/extend the information in the Gelman paper to:\n\nIn small groups:\n\n1. Sell more radon systems?\n2. Reduce the burden of inequality in radon-associated risk?\n3. Identify potential sources of geographic variation in household-based radon?\n4. Anything else?\n\n# As the soil uranium ‚ò¢Ô∏è increases, so does baseline county-level radon {.imgslide}\n\n<img src=\"../images/gelman_county_uranium.png\" style=\"width:70%\">\n\n# Counties with lots of soil uranium seem like a good bet for business {.imgslide}\n\n<img src=\"../images/radon_map.png\">\n\n\n# Partial pooling most benefits predictions for places with <span class=\"alert\">less data</span> {.imgslide}\n\n<img src=\"../images/gelman_basement_effect.png\" style=\"width:70%\">\n\nLight dotted line = full pooling; Light solid line = no pooling; Dark line = partial pooling \n\n# Next Time {.imgslide}\n\n- In-class workshop\n\n",
    "supporting": [
      "session_20_threefold_path_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}